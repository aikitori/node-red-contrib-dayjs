<script type="text/javascript">
    RED.nodes.registerType('day.js',{
        category: 'parser',
        color: '#E9967A',
        defaults: {
            name: {value:""},
            inputFormat: {value:""},
            inputTimezone: {value:""},
            outputFormat: {value:"ISOString"},
            costumFormatOutput: {value:"YYYY-MM-DDTHH:mm:ssZ"},
            outputTimezone:{value:"utc"},
            inputProperty:{value:"payload"},
            outputProperty:{value:"payload"},
            manipulateOperation:{value:""},
            manipulateUnit:{value:""},
            manipulateAmount:{value:""}
        },
        inputs: 1,
        outputs: 1,
        icon: "font-awesome/fa-calendar",
        label: function() {
            return this.name||"day.js";
        },
        oneditprepare: function() {
            $("#node-input-inputProperty").typedInput({default:'msg',types:['msg']});
            $("#node-input-outputProperty").typedInput({default:'msg',types:['msg']});
        }
    });
</script>

<script type="text/html" data-template-name="day.js">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i>
            Name
        </label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>


<h4>Input</h4>

<div class="form-row">
    <label for="node-input-inputProperty"><i class="fa fa-ellipsis-h"></i>
        <span data-i18n="node-red:common.label.property"></span>
    </label>
    <input type="text" id="node-input-inputProperty" placeholder="payload">
</div>

<div class="form-row">
    <label for="node-input-inputFormat"><i class="fa fa-code"></i>
        Input Format
    </label>
    <input type="text" id="node-input-inputFormat" placeholder="">
</div>

<div class="form-row">
    <label for="node-input-inputTimezone"><i class="fa fa-calendar"></i>
        Input Timezone
    </label>
    <input type="text" id="node-input-inputTimezone" placeholder="">
</div>

<h4>Manipulate</h4>
<div class="form-row">
    <label for="node-input-manipulateOperation"><i class="fa fa-ellipsis-h"></i> Operation</label>
    <select type="text" id="node-input-manipulateOperation" style="width: 70%">
        <option value=""></option>
        <option value="add">Add</option>
        <option value="subtract">Subtract</option>
        <option value="startOf">Start of Time</option>
        <option value="endOf">End of Time</option>
    </select>
</div>
<div class="form-row">
<label for="node-input-manipulateUnit"><i class="fa fa-ellipsis-h"></i> Unit</label>
<select type="text" id="node-input-manipulateUnit" style="width: 70%">
    <option value=""></option>
    <option value="year">Year</option>
    <option value="quarter">Quarter</option>
    <option value="month">Month</option>
    <option value="week">Week</option>
    <option value="isoWeek">Iso-Week</option>
    <option value="day">Day</option>
    <option value="hour">Hour</option>
    <option value="minute">Minute</option>
    <option value="second">Second</option>
</select>
</div>

<div class="form-row">
    <label for="node-input-manipulateAmount"><i class="fa fa-ellipsis-h"></i> Amount</label>
    <input type="text" id="node-input-manipulateAmount" placeholder="0">
</div>

<h4>Output</h4>   

<div class="form-row">
    <label for="node-input-outputProperty"><i class="fa fa-ellipsis-h"></i>
        <span data-i18n="node-red:common.label.property"></span>
    </label>
    <input type="text" id="node-input-outputProperty" placeholder="payload">
</div>

    <div class="form-row">
        <label for="node-input-outputFormat"><i class="fa fa-ellipsis-h"></i>  Type</label>
        <select type="text" id="node-input-outputFormat" style="width: 70%">
            <option value="ISOString">ISOString</option>
            <option value="Date">Javascript Date</option>
            <option value="Array">Array</option>
            <option value="Object">Object</option>
            <option value="unix_millis">Unix Timestamp (milliseconds)</option>
            <option value="unix">Unix Timestamp</option>
            <option value="fromNow">Time from now</option>
            <option value="toNow">Time to now</option>
            <option value="daysInMonth">Days in Month</option>
            <option value="Costum">Costum Format String</option>

        </select>
    </div>

    <div class="form-row">
        <label for="node-input-outputTimezone"><i class="fa fa-calendar"></i> Timezone</label>
        <input type="text" id="node-input-outputTimezone" placeholder="utc">
    </div>

    <div class="form-row">
        <label for="node-input-costumFormatOutput"><i class="fa fa-code"></i> Format</label>
        <input type="text" id="node-input-costumFormatOutput" placeholder="YYYY-MM-DDTHH:mm:ssZ">
    </div>


</script>

<script type="text/html" data-help-name="day.js">
    <p>A wrapper Node for day.js</p>
    <h3>Input</h3>
    Expect a parsable String:
    <code>
        '2018-04-04T16:00:00.000Z' <br>
        '2018-04-13 19:18:17.040+02:00' <br>
        '2018-04-13 19:18' <br>
        1318781876406 <br>
        1318781876 <br>
    </code>
    If the Input i not parsable, the current time us used

    <h3>Manipulate</h3>
    <h4>Operations</h4>
    <p>Message Property: <code>msg.operation</code></p>
        <ul>
            <li>add</li>
            <li>subtract</li>
            <li>startOf</li>
            <li>endOf</li>
        </ul>
    <h4>Units</h4>
    <p>Message Property: <code>msg.unit</code></p>
        <ul>
            <li>year</li>
            <li>quarter</li>
            <li>month</li>
            <li>week</li>
            <li>isoWeek</li>
            <li>day</li>
            <li>hour</li>
            <li>minute</li>
            <li>second</li>
        </ul>
    <h4>Amount</h4>
        <p>Message Property: <code>msg.amount</code></p>
    <h3>Output</h3>
    By default, the Output is an ISO String, but i can be changed.<br>
    
    You can also set a Costum Output Format (<a href="https://day.js.org/docs/en/display/format">Format Options</a>)
   
    You can also change the Timezone (e.g. 'utc', 'Europe/Paris')


</script>
